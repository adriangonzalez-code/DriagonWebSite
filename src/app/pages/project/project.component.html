<section id="projects" class="flex flex-col justify-center px-6 bg-gradient-to-r from-black to-gray-900 py-20 animate__animated animate__fadeIn">
  <header>
    <h2 class="text-5xl font-bold text-center mb-10 mt-5 animate__animated animate__zoomIn text-gray-400">
      Projects
    </h2>
  </header>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
    <div *ngFor="let project of projects; let i = index"
         class="bg-gradient-to-br from-gray-800 to-gray-600 border border-gray-600 text-white rounded-xl p-6 shadow-md hover:shadow-lg transition transform hover:-translate-y-1 cursor-pointer opacity-0 animate-zoomFromBack"
         [style.animationDelay]="(i * 0.2) + 's'"
         (click)="openModal(project)">
    <h3 class="font-bold mb-2 text-xl">{{ project.name }}</h3>
      <p class="text-gray-400 text-lg mb-3 text-justify">{{ project.description }}</p>
      <div class="flex flex-wrap gap-2 text-red-500 text-sm font-mono">
        <span *ngFor="let tech of project.technologies"
              class="bg-red-700 text-white px-3 py-1 rounded-full text-xs font-semibold shadow-sm">
          {{ tech }}
        </span>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div *ngIf="selectedProject"
       class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center px-4 animate__animated animate__fadeIn animate__faster"
       role="dialog" aria-modal="true" aria-labelledby="projectTitle">

    <div class="bg-white text-gray-900 max-w-3xl w-full rounded-2xl p-6 shadow-2xl overflow-y-auto max-h-[90vh] relative
            animate__animated"
         [ngClass]="{
       'animate__fadeInDown animate__faster': opening,
       'animate__fadeOutUp animate__faster': closing
     }">
      <div class="flex justify-between items-center mb-4">
        <h3 id="projectTitle" class="text-2xl font-bold">{{ selectedProject.name }}</h3>
        <button (click)="closeModal()"
                class="text-gray-600 hover:text-red-600 text-2xl font-bold transition"
                aria-label="Close modal">
          &times;
        </button>
      </div>

      <p class="mb-4 text-gray-700 text-justify">{{ selectedProject.overview }}</p>

      <h4 class="text-lg font-semibold text-red-600 mt-4">Tech Stack</h4>
      <div class="flex flex-wrap gap-2 mt-2 mb-6">
      <span *ngFor="let tech of selectedProject.technologies"
            class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium">
        {{ tech }}
      </span>
      </div>

      <ng-container *ngIf="selectedProject.media && selectedProject.media.length">
        <h4 class="text-lg font-semibold text-red-600 mb-2">Gallery</h4>

        <!-- Carrusel -->
        <div class="relative w-full rounded-xl shadow-lg mb-6">
          <div class="flex items-center justify-center bg-gradient-to-br from-black to-gray-900 min-h-[300px] rounded-xl">
          <div class="relative w-full h-[400px]">
              <img *ngFor="let img of selectedProject.media; let i = index"
                   [src]="img"
                   [alt]="'Screenshot ' + (i + 1) + ' of ' + selectedProject.name"
                   class="absolute top-0 left-0 w-full h-full object-contain rounded transition-opacity duration-500 ease-in-out"
                   [ngClass]="{
         'opacity-100 z-10': currentSlide === i,
         'opacity-0 z-0': currentSlide !== i
       }"
                   loading="lazy" />
            </div>
          </div>

          <!-- Flechas -->
          <button *ngIf="selectedProject.media.length > 1"
                  (click)="prevSlide()"
                  class="absolute top-1/2 left-4 transform -translate-y-1/2 bg-black/60 hover:bg-black/80 text-white px-4 py-2 rounded-full z-10 text-5xl">
            ‹
          </button>
          <button *ngIf="selectedProject.media.length > 1"
                  (click)="nextSlide()"
                  class="absolute top-1/2 right-4 transform -translate-y-1/2 bg-black/60 hover:bg-black/80 text-white px-4 py-2 rounded-full z-10 text-5xl">
          ›
          </button>
        </div>
      </ng-container>

      <div class="flex gap-4">
        <button *ngIf="selectedProject.github"
                (click)="openInNewTab(selectedProject.github)"
                class="inline-flex items-center gap-2 px-4 py-2 bg-black text-white rounded hover:bg-gray-800 transition text-sm font-semibold shadow-sm"
                type="button"
                aria-label="Open GitHub repository">
          <fa-icon [icon]="faGithub"></fa-icon>
          View on GitHub
        </button>
      </div>
    </div>
  </div>
</section>
